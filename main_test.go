package main

import (
	"errors"
	"io"
	"sort"
	"strings"
	"testing"

	"reflect"

	"bytes"
	"io/ioutil"
	"log"

	"github.com/influx6/faux/tests"
)

func TestGeoDisk_distanceWithCSVFile(t *testing.T) {
	records, err := distanceWithCSVFile(
		"./static/test.csv",
		housingAnywhereGeoLatitudeRadians,
		housingAnywhereGeoLongitudeRadians,
	)
	if err != nil {
		tests.FailedWithError(err, "Should have successfully parsed csv file")
	}
	tests.Passed("Should have successfully parsed csv file")

	if len(records) != 1 {
		tests.Failed("Should have parsed a total of 1 GeoRecord from file")
	}
	tests.Passed("Should have parsed a total of 1 GeoRecord from file")

}

func TestGeoDisk_distanceWithCSVFileSorting(t *testing.T) {
	records, err := distanceWithCSVFile(
		"./static/geoData.csv",
		housingAnywhereGeoLatitudeRadians,
		housingAnywhereGeoLongitudeRadians,
	)
	if err != nil {
		tests.FailedWithError(err, "Should have successfully parsed csv file")
	}
	tests.Passed("Should have successfully parsed csv file")

	for index, rec := range records {
		erec := expectedBeforeSort[index]
		if !reflect.DeepEqual(erec, rec) {
			tests.Info("Received: %#v", rec)
			tests.Info("Expected: %#v", erec)
			tests.Failed("Should have matched record at index %d", index)
		}
	}

	sort.Sort(GeoRecords(records))

	for index, rec := range records {
		erec := expectedAfterSort[index]
		if !reflect.DeepEqual(erec, rec) {
			tests.Info("Received: %#v", rec)
			tests.Info("Expected: %#v", erec)
			tests.Failed("Should have matched record at index %d", index)
		}
	}

	tests.Passed("Should have successfully matched received records with expected")
}

func TestGeoDisk_distanceWithCSVReader(t *testing.T) {
	tasks := []struct {
		Title    string
		Reader   io.Reader
		CheckErr func(error)
		Check    func([]GeoRecord) error
	}{
		{
			Title: "Should have only parsed a single record",
			Reader: strings.NewReader(`"id","lat","lng"
382582,37.1768672,-3.608897`),
			Check: func(records []GeoRecord) error {
				if len(records) != 1 {
					return errors.New("Expected only 1 item in slice")
				}
				return nil
			},
		},
		{
			Title:  "Should have failed to parse csv record without header",
			Reader: strings.NewReader(`382582,37.1768672,-3.608897,43.32232`),
			CheckErr: func(err error) {
				if err == nil {
					tests.Failed("Should have failed to parsed csv data")
				}
				tests.Passed("Passed!")
			},
		},
		{
			Title: "Should have failed to parse csv record with more than 3 lines",
			Reader: strings.NewReader(`"id","lat","lng"
382582,37.1768672,-3.608897,43.32232`),
			CheckErr: func(err error) {
				if err == nil {
					tests.Failed("Should have failed to parsed csv data")
				}
				tests.Passed("Passed!")
			},
		},
		{
			Title: "Should have parsed expected record",
			Reader: strings.NewReader(`"id","lat","lng"
382582,37.1768672,-3.608897`),
			Check: func(records []GeoRecord) error {
				var expected GeoRecord
				expected.ID = "382582"
				expected.Lat = 0.6488587382166852
				expected.Long = -0.0629871350153458
				expected.Dist = 1758.0806131200138

				if !reflect.DeepEqual(records[0], expected) {
					tests.Info("Received: %#v", records[0])
					tests.Info("Expected: %#v", expected)
					return errors.New("not matching expected")
				}
				return nil
			},
		},
	}

	for _, task := range tasks {
		tests.Info("Task: %q", task.Title)
		records, readErr := distanceWithCSVReader(
			task.Reader,
			housingAnywhereGeoLatitudeRadians,
			housingAnywhereGeoLongitudeRadians,
		)
		if readErr != nil {
			if task.CheckErr == nil {
				tests.FailedWithError(readErr, "Should have successfully parsed CSV reader")
				continue
			}

			task.CheckErr(readErr)
			continue
		}

		if err := task.Check(records); err != nil {
			tests.FailedWithError(readErr, "Failed!")
			continue
		}
		tests.Passed("Passed!")
	}
}

func Benchmark_distanceWithCSVReader(b *testing.B) {
	b.ResetTimer()
	b.ReportAllocs()
	b.StopTimer()

	csvData, err := ioutil.ReadFile("./static/geoData.csv")
	if err != nil {
		log.Fatal(err)
		return
	}

	csvReader := bytes.NewReader(csvData)

	b.StartTimer()
	for i := 0; i < b.N; i++ {
		distanceWithCSVReader(csvReader, 0, 0)
	}
	b.StopTimer()
}

var (
	expectedBeforeSort = []GeoRecord{GeoRecord{ID: "382582", Lat: 0.6488587382166852, Long: -0.0629871350153458, Dist: 1758.0806131200138}, GeoRecord{ID: "482365", Lat: 0.913935009611722, Long: 0.08607427880222746, Dist: 57.82550791172726}, GeoRecord{ID: "28403", Lat: 0.9062545608292857, Long: 0.07840075548626291, Dist: 0.9222312128573552}, GeoRecord{ID: "1098606", Lat: 0.910262705965832, Long: 0.07839783205976582, Dist: 25.487011713653}, GeoRecord{ID: "24389", Lat: 0.8875231235555341, Long: 0.09953927406987795, Dist: 146.54703297913522}, GeoRecord{ID: "19880", Lat: 0.9290662078843985, Long: 0.1138944588145449, Dist: 200.5716419654899}, GeoRecord{ID: "436807", Lat: 0.9062182614715025, Long: 0.07878427239076691, Dist: 2.4448331880502483}, GeoRecord{ID: "420178", Lat: 0.8874866845714109, Long: 0.09931575847922129, Dist: 146.2246395475015}, GeoRecord{ID: "22238", Lat: 0.8874026469679275, Long: 0.09975754145547386, Dist: 147.6794192693373}, GeoRecord{ID: "7818", Lat: 0.6608995308520743, Long: -2.133823818071707, Dist: 8776.646278220527}, GeoRecord{ID: "505868", Lat: 0.909280146683483, Long: 0.08930616257401067, Dist: 47.71985136563541}, GeoRecord{ID: "381769", Lat: 0.9126925585864464, Long: 0.08715222556418568, Dist: 53.973513637705196}, GeoRecord{ID: "419117", Lat: 0.852860484930528, Long: 0.04152973954140364, Dist: 371.313203576673}, GeoRecord{ID: "23928", Lat: 0.8877650035005802, Long: 0.0996123667136222, Dist: 145.45684074208856}, GeoRecord{ID: "1049729", Lat: 0.9140577341834052, Long: 0.08557454391349167, Dist: 57.477790804949834}, GeoRecord{ID: "90872", Lat: 0.9086558581180078, Long: 0.07392642417986249, Dist: 22.555559450959873}, GeoRecord{ID: "492800", Lat: 0.9086618201627328, Long: 0.0920418056062206, Dist: 56.53273860522266}, GeoRecord{ID: "41238", Lat: 0.9059249745986683, Long: 0.07775356820100164, Dist: 2.705735668144404}, GeoRecord{ID: "488611", Lat: 0.9057881722012384, Long: 0.07872167964780263, Dist: 3.7387608806053314}, GeoRecord{ID: "636618", Lat: 0.8875598417923375, Long: 0.09920700177754178, Dist: 145.5925659759438}, GeoRecord{ID: "22310", Lat: 0.9062010682330411, Long: 0.07864584509180349, Dist: 1.9261799993945015}, GeoRecord{ID: "19328", Lat: 0.9101691126846939, Long: 0.07763899780758374, Dist: 24.960414345025843}, GeoRecord{ID: "28257", Lat: 0.9077856264809882, Long: 0.07595873268477452, Dist: 12.999529826941401}, GeoRecord{ID: "41124", Lat: 0.906130406832945, Long: 0.07899400337099129, Dist: 3.3618418841268913}, GeoRecord{ID: "422000", Lat: 0.9000054810010193, Long: -0.004077298572168993, Dist: 326.80296602073633}, GeoRecord{ID: "285782", Lat: 0.9062684257248634, Long: 0.0783008772744883, Dist: 0.5280320575225541}, GeoRecord{ID: "1049721", Lat: 0.9289509568125721, Long: 0.1147634495224666, Dist: 202.3880236623726}, GeoRecord{ID: "270765", Lat: 0.852704703822812, Long: 0.041679357891530856, Dist: 371.9860190620279}, GeoRecord{ID: "41784", Lat: 0.9061747643758845, Long: 0.0776194972438512, Dist: 2.224856836016435}, GeoRecord{ID: "442406", Lat: 0.9063000371282756, Long: 0.07822944618419192, Dist: 0.33383815568463737}, GeoRecord{ID: "25182", Lat: 0.9062606816989722, Long: 0.07837563321700972, Dist: 0.8216419667394957}, GeoRecord{ID: "224462", Lat: 0.7226196545689103, Long: 0.03724242550034218, Dist: 1183.4385426353692}, GeoRecord{ID: "381783", Lat: 0.7269676170561494, Long: -0.015353225097481119, Dist: 1212.1249247198234}, GeoRecord{ID: "481742", Lat: 0.9059994617604848, Long: 0.07763262386515546, Dist: 2.694438616036419}, GeoRecord{ID: "900838", Lat: 0.9135344164058167, Long: 0.08669200667504431, Dist: 57.0666606918581}, GeoRecord{ID: "12714", Lat: 0.929032592843005, Long: 0.11441577295415234, Dist: 201.8164313238765}, GeoRecord{ID: "512718", Lat: 0.908958700668497, Long: 0.08958078838648273, Dist: 47.945393063518836}, GeoRecord{ID: "378673", Lat: 0.8533097536239422, Long: 0.04081459437105747, Dist: 369.8560969661567}, GeoRecord{ID: "1144546", Lat: 0.9135997074278044, Long: 0.08489664406938305, Dist: 53.63200052905595}, GeoRecord{ID: "519522", Lat: 0.907826088449037, Long: 0.0758816310197384, Dist: 13.39337669220937}, GeoRecord{ID: "505845", Lat: 0.9063631656873201, Long: 0.07869258326384264, Dist: 2.159384930813392}, GeoRecord{ID: "264170", Lat: 0.7222508926779028, Long: 0.03818076861142114, Dist: 1185.1612063811322}, GeoRecord{ID: "529990", Lat: 0.8872531298468967, Long: 0.09936504483196835, Dist: 147.56327825379321}, GeoRecord{ID: "285573", Lat: 0.9073841518838104, Long: 0.07581132217615107, Dist: 11.677766627506417}, GeoRecord{ID: "259934", Lat: 0.9171652859352641, Long: 0.23421114284580027, Dist: 612.3605958257752}, GeoRecord{ID: "260185", Lat: 0.9120353024967303, Long: 0.10801819004115079, Dist: 122.49586989586136}, GeoRecord{ID: "13506", Lat: 0.8870683082057569, Long: 0.09959403028450077, Dist: 149.05539299934327}, GeoRecord{ID: "383227", Lat: 0.688941318810176, Long: -0.006555238504334203, Dist: 1434.14505037834}, GeoRecord{ID: "441750", Lat: 0.9059863229218759, Long: 0.07749914631995068, Dist: 3.1664560207476433}, GeoRecord{ID: "413700", Lat: 0.9059602930814117, Long: 0.07406146030408932, Dist: 16.248206805791156}, GeoRecord{ID: "201844", Lat: 0.9061843305255146, Long: 0.07871510848316889, Dist: 2.2151990702390942}, GeoRecord{ID: "444464", Lat: 0.9063962553846087, Long: 0.07862798339223856, Dist: 1.9967792079884303}, GeoRecord{ID: "577771", Lat: 0.9087258266223911, Long: 0.08933394472504391, Dist: 46.528052688998905}, GeoRecord{ID: "382693", Lat: 0.7150655815869524, Long: -0.09880399652661002, Dist: 1441.7191536957157}, GeoRecord{ID: "382013", Lat: 0.6527435409349933, Long: -0.10422258062893668, Dist: 1810.117975607402}, GeoRecord{ID: "453904", Lat: 0.9104087167203954, Long: 0.07854917828585252, Dist: 26.44365965517413}, GeoRecord{ID: "224458", Lat: 0.928875708687202, Long: 0.11390616822849652, Dist: 199.7379058712859}, GeoRecord{ID: "841036", Lat: 0.9131844080776217, Long: 0.08644947048619946, Dist: 54.70970847874591}, GeoRecord{ID: "206888", Lat: 0.928990668289043, Long: 0.1142555901260628, Dist: 201.19624494684314}, GeoRecord{ID: "12533", Lat: 0.9064492941952476, Long: 0.07795199991964866, Dist: 1.4467124691687403}, GeoRecord{ID: "206311", Lat: 0.9061843305255146, Long: 0.07871510848316889, Dist: 2.2151990702390942}, GeoRecord{ID: "503071", Lat: 0.9283680168424062, Long: 0.1011250121603992, Dist: 166.53986120985937}, GeoRecord{ID: "133451", Lat: 0.7056539232661702, Long: -0.06494199104404205, Dist: 1423.3803112856317}, GeoRecord{ID: "280398", Lat: 0.9167361496147717, Long: 0.2341940386191307, Dist: 612.1593698053672}, GeoRecord{ID: "381823", Lat: 0.6487040461944226, Long: -0.06288398605655295, Dist: 1758.8482704875876}, GeoRecord{ID: "254577", Lat: 0.9064371833555681, Long: 0.07820308124051133, Dist: 1.107797839290775}, GeoRecord{ID: "537608", Lat: 0.9290893614222554, Long: 0.11407977961985091, Dist: 201.17202562757265}, GeoRecord{ID: "50356", Lat: 0.9063702848853391, Long: 0.0780150551748647, Dist: 0.8980480884583061}, GeoRecord{ID: "402981", Lat: 0.9103400694302558, Long: 0.07835547117349069, Dist: 25.97432741657886}, GeoRecord{ID: "265405", Lat: 0.9141527132559696, Long: 0.08525362324261046, Dist: 57.384355559178026}, GeoRecord{ID: "498815", Lat: 0.8874211369860231, Long: 0.09887526355595672, Dist: 145.5709147629935}, GeoRecord{ID: "478223", Lat: 0.9059621832729915, Long: 0.07785602950006924, Dist: 2.281612909956315}, GeoRecord{ID: "442637", Lat: 0.9140138443887054, Long: 0.08472475182734189, Dist: 55.62974461881273}, GeoRecord{ID: "23876", Lat: 0.9087224127583743, Long: 0.07544819071731038, Dist: 18.944083031483522}, GeoRecord{ID: "201792", Lat: 0.9064219710658077, Long: 0.07829526080495539, Dist: 1.1218670852579724}, GeoRecord{ID: "381791", Lat: 0.8992140684330195, Long: -0.00552789407337904, Dist: 333.28559505115777}, GeoRecord{ID: "286275", Lat: 0.9091955750092484, Long: 0.0888418753223829, Dist: 45.83907172289803}, GeoRecord{ID: "19405", Lat: 0.9074486452903298, Long: 0.07601021466172059, Dist: 11.338506173359999}, GeoRecord{ID: "249739", Lat: 0.9286411416717215, Long: 0.10091207501033886, Dist: 167.5704441794565}, GeoRecord{ID: "271949", Lat: 0.9089418861664833, Long: 0.07530903910670737, Dist: 20.40894412208664}, GeoRecord{ID: "508337", Lat: 0.9060613720797115, Long: 0.0789318661589618, Dist: 3.2743356576975273}, GeoRecord{ID: "429151", Lat: 0.9062732044363552, Long: 0.07833097722276819, Dist: 0.6480104060043134}, GeoRecord{ID: "228617", Lat: 0.9288719876452365, Long: 0.11460845555824326, Dist: 201.61395508870666}, GeoRecord{ID: "24624", Lat: 0.9021984418275895, Long: 0.07356037278518324, Dist: 31.628622726545064}, GeoRecord{ID: "381776", Lat: 0.9153811108901083, Long: -0.0322092135875144, Dist: 434.88198961829676}, GeoRecord{ID: "1099981", Lat: 0.8874644682753623, Long: 0.0992859168396707, Dist: 146.27299939661145}, GeoRecord{ID: "512818", Lat: 0.9062938953146378, Long: 0.07834908675908689, Dist: 0.7405525423044468}, GeoRecord{ID: "520857", Lat: 0.9057374599144925, Long: 0.0786429356279404, Dist: 3.8458435500144503}, GeoRecord{ID: "736914", Lat: 0.8978071759762793, Long: 0.09550240954048993, Dist: 87.13465252763758}, GeoRecord{ID: "1144327", Lat: 0.9045320604839073, Long: 0.10172795709445166, Dist: 93.32709887522282}, GeoRecord{ID: "276619", Lat: 0.8531878458663491, Long: 0.04071445261456579, Dist: 370.7354873953059}, GeoRecord{ID: "382095", Lat: 0.730568011391528, Long: 0.21786541881588, Dist: 1272.1517044658253}, GeoRecord{ID: "482231", Lat: 0.9060679798962598, Long: 0.07766536449659361, Dist: 2.3347722913586635}, GeoRecord{ID: "498405", Lat: 0.9290455780926398, Long: 0.11411520805833716, Dist: 201.0681675307497}, GeoRecord{ID: "20020", Lat: 0.9062169245492956, Long: 0.07878301924436398, Dist: 2.440996751971632}, GeoRecord{ID: "201531", Lat: 0.9062286060379792, Long: 0.07862635674537571, Dist: 1.8209748754541766}, GeoRecord{ID: "440291", Lat: 0.9001311429618336, Long: 0.08398978495268082, Dist: 45.32734037620078}, GeoRecord{ID: "383149", Lat: 0.6889043317926677, Long: -0.006716384754170839, Dist: 1434.559586869351}, GeoRecord{ID: "19097", Lat: 0.8875933451326589, Long: 0.0987671578620882, Dist: 144.41834147470897}, GeoRecord{ID: "286501", Lat: 0.9167239096207273, Long: 0.23412433540479383, Dist: 611.8858074698588}}
	expectedAfterSort  = []GeoRecord{GeoRecord{ID: "442406", Lat: 0.9063000371282756, Long: 0.07822944618419192, Dist: 0.33383815568463737}, GeoRecord{ID: "285782", Lat: 0.9062684257248634, Long: 0.0783008772744883, Dist: 0.5280320575225541}, GeoRecord{ID: "429151", Lat: 0.9062732044363552, Long: 0.07833097722276819, Dist: 0.6480104060043134}, GeoRecord{ID: "512818", Lat: 0.9062938953146378, Long: 0.07834908675908689, Dist: 0.7405525423044468}, GeoRecord{ID: "25182", Lat: 0.9062606816989722, Long: 0.07837563321700972, Dist: 0.8216419667394957}, GeoRecord{ID: "50356", Lat: 0.9063702848853391, Long: 0.0780150551748647, Dist: 0.8980480884583061}, GeoRecord{ID: "28403", Lat: 0.9062545608292857, Long: 0.07840075548626291, Dist: 0.9222312128573552}, GeoRecord{ID: "254577", Lat: 0.9064371833555681, Long: 0.07820308124051133, Dist: 1.107797839290775}, GeoRecord{ID: "201792", Lat: 0.9064219710658077, Long: 0.07829526080495539, Dist: 1.1218670852579724}, GeoRecord{ID: "12533", Lat: 0.9064492941952476, Long: 0.07795199991964866, Dist: 1.4467124691687403}, GeoRecord{ID: "201531", Lat: 0.9062286060379792, Long: 0.07862635674537571, Dist: 1.8209748754541766}, GeoRecord{ID: "22310", Lat: 0.9062010682330411, Long: 0.07864584509180349, Dist: 1.9261799993945015}, GeoRecord{ID: "444464", Lat: 0.9063962553846087, Long: 0.07862798339223856, Dist: 1.9967792079884303}, GeoRecord{ID: "505845", Lat: 0.9063631656873201, Long: 0.07869258326384264, Dist: 2.159384930813392}, GeoRecord{ID: "206311", Lat: 0.9061843305255146, Long: 0.07871510848316889, Dist: 2.2151990702390942}, GeoRecord{ID: "201844", Lat: 0.9061843305255146, Long: 0.07871510848316889, Dist: 2.2151990702390942}, GeoRecord{ID: "41784", Lat: 0.9061747643758845, Long: 0.0776194972438512, Dist: 2.224856836016435}, GeoRecord{ID: "478223", Lat: 0.9059621832729915, Long: 0.07785602950006924, Dist: 2.281612909956315}, GeoRecord{ID: "482231", Lat: 0.9060679798962598, Long: 0.07766536449659361, Dist: 2.3347722913586635}, GeoRecord{ID: "20020", Lat: 0.9062169245492956, Long: 0.07878301924436398, Dist: 2.440996751971632}, GeoRecord{ID: "436807", Lat: 0.9062182614715025, Long: 0.07878427239076691, Dist: 2.4448331880502483}, GeoRecord{ID: "481742", Lat: 0.9059994617604848, Long: 0.07763262386515546, Dist: 2.694438616036419}, GeoRecord{ID: "41238", Lat: 0.9059249745986683, Long: 0.07775356820100164, Dist: 2.705735668144404}, GeoRecord{ID: "441750", Lat: 0.9059863229218759, Long: 0.07749914631995068, Dist: 3.1664560207476433}, GeoRecord{ID: "508337", Lat: 0.9060613720797115, Long: 0.0789318661589618, Dist: 3.2743356576975273}, GeoRecord{ID: "41124", Lat: 0.906130406832945, Long: 0.07899400337099129, Dist: 3.3618418841268913}, GeoRecord{ID: "488611", Lat: 0.9057881722012384, Long: 0.07872167964780263, Dist: 3.7387608806053314}, GeoRecord{ID: "520857", Lat: 0.9057374599144925, Long: 0.0786429356279404, Dist: 3.8458435500144503}, GeoRecord{ID: "19405", Lat: 0.9074486452903298, Long: 0.07601021466172059, Dist: 11.338506173359999}, GeoRecord{ID: "285573", Lat: 0.9073841518838104, Long: 0.07581132217615107, Dist: 11.677766627506417}, GeoRecord{ID: "28257", Lat: 0.9077856264809882, Long: 0.07595873268477452, Dist: 12.999529826941401}, GeoRecord{ID: "519522", Lat: 0.907826088449037, Long: 0.0758816310197384, Dist: 13.39337669220937}, GeoRecord{ID: "413700", Lat: 0.9059602930814117, Long: 0.07406146030408932, Dist: 16.248206805791156}, GeoRecord{ID: "23876", Lat: 0.9087224127583743, Long: 0.07544819071731038, Dist: 18.944083031483522}, GeoRecord{ID: "271949", Lat: 0.9089418861664833, Long: 0.07530903910670737, Dist: 20.40894412208664}, GeoRecord{ID: "90872", Lat: 0.9086558581180078, Long: 0.07392642417986249, Dist: 22.555559450959873}, GeoRecord{ID: "19328", Lat: 0.9101691126846939, Long: 0.07763899780758374, Dist: 24.960414345025843}, GeoRecord{ID: "1098606", Lat: 0.910262705965832, Long: 0.07839783205976582, Dist: 25.487011713653}, GeoRecord{ID: "402981", Lat: 0.9103400694302558, Long: 0.07835547117349069, Dist: 25.97432741657886}, GeoRecord{ID: "453904", Lat: 0.9104087167203954, Long: 0.07854917828585252, Dist: 26.44365965517413}, GeoRecord{ID: "24624", Lat: 0.9021984418275895, Long: 0.07356037278518324, Dist: 31.628622726545064}, GeoRecord{ID: "440291", Lat: 0.9001311429618336, Long: 0.08398978495268082, Dist: 45.32734037620078}, GeoRecord{ID: "286275", Lat: 0.9091955750092484, Long: 0.0888418753223829, Dist: 45.83907172289803}, GeoRecord{ID: "577771", Lat: 0.9087258266223911, Long: 0.08933394472504391, Dist: 46.528052688998905}, GeoRecord{ID: "505868", Lat: 0.909280146683483, Long: 0.08930616257401067, Dist: 47.71985136563541}, GeoRecord{ID: "512718", Lat: 0.908958700668497, Long: 0.08958078838648273, Dist: 47.945393063518836}, GeoRecord{ID: "1144546", Lat: 0.9135997074278044, Long: 0.08489664406938305, Dist: 53.63200052905595}, GeoRecord{ID: "381769", Lat: 0.9126925585864464, Long: 0.08715222556418568, Dist: 53.973513637705196}, GeoRecord{ID: "841036", Lat: 0.9131844080776217, Long: 0.08644947048619946, Dist: 54.70970847874591}, GeoRecord{ID: "442637", Lat: 0.9140138443887054, Long: 0.08472475182734189, Dist: 55.62974461881273}, GeoRecord{ID: "492800", Lat: 0.9086618201627328, Long: 0.0920418056062206, Dist: 56.53273860522266}, GeoRecord{ID: "900838", Lat: 0.9135344164058167, Long: 0.08669200667504431, Dist: 57.0666606918581}, GeoRecord{ID: "265405", Lat: 0.9141527132559696, Long: 0.08525362324261046, Dist: 57.384355559178026}, GeoRecord{ID: "1049729", Lat: 0.9140577341834052, Long: 0.08557454391349167, Dist: 57.477790804949834}, GeoRecord{ID: "482365", Lat: 0.913935009611722, Long: 0.08607427880222746, Dist: 57.82550791172726}, GeoRecord{ID: "736914", Lat: 0.8978071759762793, Long: 0.09550240954048993, Dist: 87.13465252763758}, GeoRecord{ID: "1144327", Lat: 0.9045320604839073, Long: 0.10172795709445166, Dist: 93.32709887522282}, GeoRecord{ID: "260185", Lat: 0.9120353024967303, Long: 0.10801819004115079, Dist: 122.49586989586136}, GeoRecord{ID: "19097", Lat: 0.8875933451326589, Long: 0.0987671578620882, Dist: 144.41834147470897}, GeoRecord{ID: "23928", Lat: 0.8877650035005802, Long: 0.0996123667136222, Dist: 145.45684074208856}, GeoRecord{ID: "498815", Lat: 0.8874211369860231, Long: 0.09887526355595672, Dist: 145.5709147629935}, GeoRecord{ID: "636618", Lat: 0.8875598417923375, Long: 0.09920700177754178, Dist: 145.5925659759438}, GeoRecord{ID: "420178", Lat: 0.8874866845714109, Long: 0.09931575847922129, Dist: 146.2246395475015}, GeoRecord{ID: "1099981", Lat: 0.8874644682753623, Long: 0.0992859168396707, Dist: 146.27299939661145}, GeoRecord{ID: "24389", Lat: 0.8875231235555341, Long: 0.09953927406987795, Dist: 146.54703297913522}, GeoRecord{ID: "529990", Lat: 0.8872531298468967, Long: 0.09936504483196835, Dist: 147.56327825379321}, GeoRecord{ID: "22238", Lat: 0.8874026469679275, Long: 0.09975754145547386, Dist: 147.6794192693373}, GeoRecord{ID: "13506", Lat: 0.8870683082057569, Long: 0.09959403028450077, Dist: 149.05539299934327}, GeoRecord{ID: "503071", Lat: 0.9283680168424062, Long: 0.1011250121603992, Dist: 166.53986120985937}, GeoRecord{ID: "249739", Lat: 0.9286411416717215, Long: 0.10091207501033886, Dist: 167.5704441794565}, GeoRecord{ID: "224458", Lat: 0.928875708687202, Long: 0.11390616822849652, Dist: 199.7379058712859}, GeoRecord{ID: "19880", Lat: 0.9290662078843985, Long: 0.1138944588145449, Dist: 200.5716419654899}, GeoRecord{ID: "498405", Lat: 0.9290455780926398, Long: 0.11411520805833716, Dist: 201.0681675307497}, GeoRecord{ID: "537608", Lat: 0.9290893614222554, Long: 0.11407977961985091, Dist: 201.17202562757265}, GeoRecord{ID: "206888", Lat: 0.928990668289043, Long: 0.1142555901260628, Dist: 201.19624494684314}, GeoRecord{ID: "228617", Lat: 0.9288719876452365, Long: 0.11460845555824326, Dist: 201.61395508870666}, GeoRecord{ID: "12714", Lat: 0.929032592843005, Long: 0.11441577295415234, Dist: 201.8164313238765}, GeoRecord{ID: "1049721", Lat: 0.9289509568125721, Long: 0.1147634495224666, Dist: 202.3880236623726}, GeoRecord{ID: "422000", Lat: 0.9000054810010193, Long: -0.004077298572168993, Dist: 326.80296602073633}, GeoRecord{ID: "381791", Lat: 0.8992140684330195, Long: -0.00552789407337904, Dist: 333.28559505115777}, GeoRecord{ID: "378673", Lat: 0.8533097536239422, Long: 0.04081459437105747, Dist: 369.8560969661567}, GeoRecord{ID: "276619", Lat: 0.8531878458663491, Long: 0.04071445261456579, Dist: 370.7354873953059}, GeoRecord{ID: "419117", Lat: 0.852860484930528, Long: 0.04152973954140364, Dist: 371.313203576673}, GeoRecord{ID: "270765", Lat: 0.852704703822812, Long: 0.041679357891530856, Dist: 371.9860190620279}, GeoRecord{ID: "381776", Lat: 0.9153811108901083, Long: -0.0322092135875144, Dist: 434.88198961829676}, GeoRecord{ID: "286501", Lat: 0.9167239096207273, Long: 0.23412433540479383, Dist: 611.8858074698588}, GeoRecord{ID: "280398", Lat: 0.9167361496147717, Long: 0.2341940386191307, Dist: 612.1593698053672}, GeoRecord{ID: "259934", Lat: 0.9171652859352641, Long: 0.23421114284580027, Dist: 612.3605958257752}, GeoRecord{ID: "224462", Lat: 0.7226196545689103, Long: 0.03724242550034218, Dist: 1183.4385426353692}, GeoRecord{ID: "264170", Lat: 0.7222508926779028, Long: 0.03818076861142114, Dist: 1185.1612063811322}, GeoRecord{ID: "381783", Lat: 0.7269676170561494, Long: -0.015353225097481119, Dist: 1212.1249247198234}, GeoRecord{ID: "382095", Lat: 0.730568011391528, Long: 0.21786541881588, Dist: 1272.1517044658253}, GeoRecord{ID: "133451", Lat: 0.7056539232661702, Long: -0.06494199104404205, Dist: 1423.3803112856317}, GeoRecord{ID: "383227", Lat: 0.688941318810176, Long: -0.006555238504334203, Dist: 1434.14505037834}, GeoRecord{ID: "383149", Lat: 0.6889043317926677, Long: -0.006716384754170839, Dist: 1434.559586869351}, GeoRecord{ID: "382693", Lat: 0.7150655815869524, Long: -0.09880399652661002, Dist: 1441.7191536957157}, GeoRecord{ID: "382582", Lat: 0.6488587382166852, Long: -0.0629871350153458, Dist: 1758.0806131200138}, GeoRecord{ID: "381823", Lat: 0.6487040461944226, Long: -0.06288398605655295, Dist: 1758.8482704875876}, GeoRecord{ID: "382013", Lat: 0.6527435409349933, Long: -0.10422258062893668, Dist: 1810.117975607402}, GeoRecord{ID: "7818", Lat: 0.6608995308520743, Long: -2.133823818071707, Dist: 8776.646278220527}}
)
