package main

import (
	"errors"
	"io"
	"sort"
	"strings"
	"testing"

	"reflect"

	"bytes"
	"io/ioutil"

	"github.com/containous/traefik/log"
	"github.com/influx6/faux/tests"
)

func TestGeoDisk_distanceWithCSVFile(t *testing.T) {
	records, err := distanceWithCSVFile(
		"./static/test.csv",
		housingAnywhereGeoLongitudeRadians,
		housingAnywhereGeoLatitudeRadians,
	)
	if err != nil {
		tests.FailedWithError(err, "Should have successfully parsed csv file")
	}
	tests.Passed("Should have successfully parsed csv file")

	if len(records) != 1 {
		tests.Failed("Should have parsed a total of 1 GeoRecord from file")
	}
	tests.Passed("Should have parsed a total of 1 GeoRecord from file")

}

func TestGeoDisk_distanceWithCSVFileSorting(t *testing.T) {
	records, err := distanceWithCSVFile(
		"./static/geoData.csv",
		housingAnywhereGeoLongitudeRadians,
		housingAnywhereGeoLatitudeRadians,
	)
	if err != nil {
		tests.FailedWithError(err, "Should have successfully parsed csv file")
	}
	tests.Passed("Should have successfully parsed csv file")

	for index, rec := range records {
		erec := expectedBeforeSort[index]
		if !reflect.DeepEqual(erec, rec) {
			tests.Info("Received: %#v", rec)
			tests.Info("Expected: %#v", erec)
			tests.Failed("Should have matched record at index %d", index)
		}
	}

	sort.Sort(GeoRecords(records))

	for index, rec := range records {
		erec := expectedAfterSort[index]
		if !reflect.DeepEqual(erec, rec) {
			tests.Info("Received: %#v", rec)
			tests.Info("Expected: %#v", erec)
			tests.Failed("Should have matched record at index %d", index)
		}
	}

	tests.Passed("Should have successfully matched received records with expected")
}

func TestGeoDisk_distanceWithCSVReader(t *testing.T) {
	tasks := []struct {
		Title    string
		Reader   io.Reader
		CheckErr func(error)
		Check    func([]GeoRecord) error
	}{
		{
			Title: "Should have only parsed a single record",
			Reader: strings.NewReader(`"id","lat","lng"
382582,37.1768672,-3.608897`),
			Check: func(records []GeoRecord) error {
				if len(records) != 1 {
					return errors.New("Expected only 1 item in slice")
				}
				return nil
			},
		},
		{
			Title:  "Should have failed to parse csv record without header",
			Reader: strings.NewReader(`382582,37.1768672,-3.608897,43.32232`),
			CheckErr: func(err error) {
				if err == nil {
					tests.Failed("Should have failed to parsed csv data")
				}
				tests.Passed("Passed!")
			},
		},
		{
			Title: "Should have failed to parse csv record with more than 3 lines",
			Reader: strings.NewReader(`"id","lat","lng"
382582,37.1768672,-3.608897,43.32232`),
			CheckErr: func(err error) {
				if err == nil {
					tests.Failed("Should have failed to parsed csv data")
				}
				tests.Passed("Passed!")
			},
		},
		{
			Title: "Should have parsed expected record",
			Reader: strings.NewReader(`"id","lat","lng"
382582,37.1768672,-3.608897`),
			Check: func(records []GeoRecord) error {
				var expected GeoRecord
				expected.ID = "382582"
				expected.Lat = 0.6488587382166852
				expected.Long = -0.0629871350153458
				expected.Dist = 6695.821593686801

				if !reflect.DeepEqual(records[0], expected) {
					tests.Info("Received: %#v", records[0])
					tests.Info("Expected: %#v", expected)
					return errors.New("not matching expected")
				}
				return nil
			},
		},
	}

	for _, task := range tasks {
		tests.Info("Task: %q", task.Title)
		records, readErr := distanceWithCSVReader(
			task.Reader,
			housingAnywhereGeoLongitudeRadians,
			housingAnywhereGeoLatitudeRadians,
		)
		if readErr != nil {
			if task.CheckErr == nil {
				tests.FailedWithError(readErr, "Should have successfully parsed CSV reader")
				continue
			}

			task.CheckErr(readErr)
			continue
		}

		if err := task.Check(records); err != nil {
			tests.FailedWithError(readErr, "Failed!")
			continue
		}
		tests.Passed("Passed!")
	}
}

func Benchmark_distanceWithCSVReader(b *testing.B) {
	b.ResetTimer()
	b.ReportAllocs()
	b.StopTimer()

	csvData, err := ioutil.ReadFile("./static/geoData.csv")
	if err != nil {
		log.Fatal(err)
		return
	}

	csvReader := bytes.NewReader(csvData)

	b.StartTimer()
	for i := 0; i < b.N; i++ {
		distanceWithCSVReader(csvReader, 0, 0)
	}
	b.StopTimer()
}

var (
	expectedBeforeSort = []GeoRecord{GeoRecord{ID: "382582", Lat: 0.6488587382166852, Long: -0.0629871350153458, Dist: 6695.821593686801}, GeoRecord{ID: "482365", Lat: 0.913935009611722, Long: 0.08607427880222746, Dist: 6839.138946499822}, GeoRecord{ID: "28403", Lat: 0.9062545608292857, Long: 0.07840075548626291, Dist: 6837.012846904176}, GeoRecord{ID: "1098606", Lat: 0.910262705965832, Long: 0.07839783205976582, Dist: 6851.069941438913}, GeoRecord{ID: "24389", Lat: 0.8875231235555341, Long: 0.09953927406987795, Dist: 6700.914850208654}, GeoRecord{ID: "19880", Lat: 0.9290662078843985, Long: 0.1138944588145449, Dist: 6806.4690367538715}, GeoRecord{ID: "436807", Lat: 0.9062182614715025, Long: 0.07878427239076691, Dist: 6835.626790104652}, GeoRecord{ID: "420178", Lat: 0.8874866845714109, Long: 0.09931575847922129, Dist: 6701.530404262073}, GeoRecord{ID: "22238", Lat: 0.8874026469679275, Long: 0.09975754145547386, Dist: 6699.757730150401}, GeoRecord{ID: "7818", Lat: 0.6608995308520743, Long: -2.133823818071707, Dist: 15268.307349509038}, GeoRecord{ID: "505868", Lat: 0.909280146683483, Long: 0.08930616257401067, Dist: 6812.106504497622}, GeoRecord{ID: "381769", Lat: 0.9126925585864464, Long: 0.08715222556418568, Dist: 6831.235776240795}, GeoRecord{ID: "419117", Lat: 0.852860484930528, Long: 0.04152973954140364, Dist: 6786.328066723885}, GeoRecord{ID: "23928", Lat: 0.8877650035005802, Long: 0.0996123667136222, Dist: 6701.533132472086}, GeoRecord{ID: "1049729", Lat: 0.9140577341834052, Long: 0.08557454391349167, Dist: 6841.188285597731}, GeoRecord{ID: "90872", Lat: 0.9086558581180078, Long: 0.07392642417986249, Dist: 6860.0788545874375}, GeoRecord{ID: "492800", Lat: 0.9086618201627328, Long: 0.0920418056062206, Dist: 6801.02758243488}, GeoRecord{ID: "41238", Lat: 0.9059249745986683, Long: 0.07775356820100164, Dist: 6837.985726077332}, GeoRecord{ID: "488611", Lat: 0.9057881722012384, Long: 0.07872167964780263, Dist: 6834.326517927309}, GeoRecord{ID: "636618", Lat: 0.8875598417923375, Long: 0.09920700177754178, Dist: 6702.153666957753}, GeoRecord{ID: "22310", Lat: 0.9062010682330411, Long: 0.07864584509180349, Dist: 6836.020990256374}, GeoRecord{ID: "19328", Lat: 0.9101691126846939, Long: 0.07763899780758374, Dist: 6853.2180021301665}, GeoRecord{ID: "28257", Lat: 0.9077856264809882, Long: 0.07595873268477452, Dist: 6850.378415675749}, GeoRecord{ID: "41124", Lat: 0.906130406832945, Long: 0.07899400337099129, Dist: 6834.6306766367825}, GeoRecord{ID: "422000", Lat: 0.9000054810010193, Long: -0.004077298572168993, Dist: 7095.3891433696535}, GeoRecord{ID: "285782", Lat: 0.9062684257248634, Long: 0.0783008772744883, Dist: 6837.389279181325}, GeoRecord{ID: "1049721", Lat: 0.9289509568125721, Long: 0.1147634495224666, Dist: 6803.354598104192}, GeoRecord{ID: "270765", Lat: 0.852704703822812, Long: 0.041679357891530856, Dist: 6785.289878354843}, GeoRecord{ID: "41784", Lat: 0.9061747643758845, Long: 0.0776194972438512, Dist: 6839.299425593246}, GeoRecord{ID: "442406", Lat: 0.9063000371282756, Long: 0.07822944618419192, Dist: 6837.7344161520205}, GeoRecord{ID: "25182", Lat: 0.9062606816989722, Long: 0.07837563321700972, Dist: 6837.116746428064}, GeoRecord{ID: "224462", Lat: 0.7226196545689103, Long: 0.03724242550034218, Dist: 6415.637191380809}, GeoRecord{ID: "381783", Lat: 0.7269676170561494, Long: -0.015353225097481119, Dist: 6655.350457923642}, GeoRecord{ID: "481742", Lat: 0.9059994617604848, Long: 0.07763262386515546, Dist: 6838.643525578349}, GeoRecord{ID: "900838", Lat: 0.9135344164058167, Long: 0.08669200667504431, Dist: 6835.719456539301}, GeoRecord{ID: "12714", Lat: 0.929032592843005, Long: 0.11441577295415234, Dist: 6804.733412466837}, GeoRecord{ID: "512718", Lat: 0.908958700668497, Long: 0.08958078838648273, Dist: 6810.069796726029}, GeoRecord{ID: "378673", Lat: 0.8533097536239422, Long: 0.04081459437105747, Dist: 6790.3518768437625}, GeoRecord{ID: "1144546", Lat: 0.9135997074278044, Long: 0.08489664406938305, Dist: 6841.749992574303}, GeoRecord{ID: "519522", Lat: 0.907826088449037, Long: 0.0758816310197384, Dist: 6850.772569905643}, GeoRecord{ID: "505845", Lat: 0.9063631656873201, Long: 0.07869258326384264, Dist: 6836.435144865021}, GeoRecord{ID: "264170", Lat: 0.7222508926779028, Long: 0.03818076861142114, Dist: 6410.577022747781}, GeoRecord{ID: "529990", Lat: 0.8872531298468967, Long: 0.09936504483196835, Dist: 6700.534164128012}, GeoRecord{ID: "285573", Lat: 0.9073841518838104, Long: 0.07581132217615107, Dist: 6849.460933370127}, GeoRecord{ID: "259934", Lat: 0.9171652859352641, Long: 0.23421114284580027, Dist: 6400.628444189399}, GeoRecord{ID: "260185", Lat: 0.9120353024967303, Long: 0.10801819004115079, Dist: 6761.871341647243}, GeoRecord{ID: "13506", Lat: 0.8870683082057569, Long: 0.09959403028450077, Dist: 6699.111872133778}, GeoRecord{ID: "383227", Lat: 0.688941318810176, Long: -0.006555238504334203, Dist: 6521.751049245793}, GeoRecord{ID: "441750", Lat: 0.9059863229218759, Long: 0.07749914631995068, Dist: 6839.036229876827}, GeoRecord{ID: "413700", Lat: 0.9059602930814117, Long: 0.07406146030408932, Dist: 6850.255336990507}, GeoRecord{ID: "201844", Lat: 0.9061843305255146, Long: 0.07871510848316889, Dist: 6835.7350128873695}, GeoRecord{ID: "444464", Lat: 0.9063962553846087, Long: 0.07862798339223856, Dist: 6836.763016690811}, GeoRecord{ID: "577771", Lat: 0.9087258266223911, Long: 0.08933394472504391, Dist: 6810.041312793595}, GeoRecord{ID: "382693", Lat: 0.7150655815869524, Long: -0.09880399652661002, Dist: 7000.256434354976}, GeoRecord{ID: "382013", Lat: 0.6527435409349933, Long: -0.10422258062893668, Dist: 6902.308403017376}, GeoRecord{ID: "453904", Lat: 0.9104087167203954, Long: 0.07854917828585252, Dist: 6851.088800067664}, GeoRecord{ID: "224458", Lat: 0.928875708687202, Long: 0.11390616822849652, Dist: 6805.721080612187}, GeoRecord{ID: "841036", Lat: 0.9131844080776217, Long: 0.08644947048619946, Dist: 6835.256878130669}, GeoRecord{ID: "206888", Lat: 0.928990668289043, Long: 0.1142555901260628, Dist: 6805.071327151288}, GeoRecord{ID: "12533", Lat: 0.9064492941952476, Long: 0.07795199991964866, Dist: 6839.167479364043}, GeoRecord{ID: "206311", Lat: 0.9061843305255146, Long: 0.07871510848316889, Dist: 6835.7350128873695}, GeoRecord{ID: "503071", Lat: 0.9283680168424062, Long: 0.1011250121603992, Dist: 6843.52854700042}, GeoRecord{ID: "133451", Lat: 0.7056539232661702, Long: -0.06494199104404205, Dist: 6826.066177531431}, GeoRecord{ID: "280398", Lat: 0.9167361496147717, Long: 0.2341940386191307, Dist: 6398.824867596797}, GeoRecord{ID: "381823", Lat: 0.6487040461944226, Long: -0.06288398605655295, Dist: 6695.009206838496}, GeoRecord{ID: "254577", Lat: 0.9064371833555681, Long: 0.07820308124051133, Dist: 6838.300875645867}, GeoRecord{ID: "537608", Lat: 0.9290893614222554, Long: 0.11407977961985091, Dist: 6805.983195156919}, GeoRecord{ID: "50356", Lat: 0.9063702848853391, Long: 0.0780150551748647, Dist: 6838.6840772393}, GeoRecord{ID: "402981", Lat: 0.9103400694302558, Long: 0.07835547117349069, Dist: 6851.479639230558}, GeoRecord{ID: "265405", Lat: 0.9141527132559696, Long: 0.08525362324261046, Dist: 6842.561761815388}, GeoRecord{ID: "498815", Lat: 0.8874211369860231, Long: 0.09887526355595672, Dist: 6702.766387588749}, GeoRecord{ID: "478223", Lat: 0.9059621832729915, Long: 0.07785602950006924, Dist: 6837.779135174724}, GeoRecord{ID: "442637", Lat: 0.9140138443887054, Long: 0.08472475182734189, Dist: 6843.775956345362}, GeoRecord{ID: "23876", Lat: 0.9087224127583743, Long: 0.07544819071731038, Dist: 6855.322267367436}, GeoRecord{ID: "201792", Lat: 0.9064219710658077, Long: 0.07829526080495539, Dist: 6837.9450655947185}, GeoRecord{ID: "381791", Lat: 0.8992140684330195, Long: -0.00552789407337904, Dist: 7098.018779396682}, GeoRecord{ID: "286275", Lat: 0.9091955750092484, Long: 0.0888418753223829, Dist: 6813.31185562441}, GeoRecord{ID: "19405", Lat: 0.9074486452903298, Long: 0.07601021466172059, Dist: 6849.033196191546}, GeoRecord{ID: "249739", Lat: 0.9286411416717215, Long: 0.10091207501033886, Dist: 6845.195043780966}, GeoRecord{ID: "271949", Lat: 0.9089418861664833, Long: 0.07530903910670737, Dist: 6856.544202988409}, GeoRecord{ID: "508337", Lat: 0.9060613720797115, Long: 0.0789318661589618, Dist: 6834.592861941546}, GeoRecord{ID: "429151", Lat: 0.9062732044363552, Long: 0.07833097722276819, Dist: 6837.307180676477}, GeoRecord{ID: "228617", Lat: 0.9288719876452365, Long: 0.11460845555824326, Dist: 6803.537824233478}, GeoRecord{ID: "24624", Lat: 0.9021984418275895, Long: 0.07356037278518324, Dist: 6838.853801155598}, GeoRecord{ID: "381776", Lat: 0.9153811108901083, Long: -0.0322092135875144, Dist: 7238.853148385706}, GeoRecord{ID: "1099981", Lat: 0.8874644682753623, Long: 0.0992859168396707, Dist: 6701.550803150888}, GeoRecord{ID: "512818", Lat: 0.9062938953146378, Long: 0.07834908675908689, Dist: 6837.320138433589}, GeoRecord{ID: "520857", Lat: 0.9057374599144925, Long: 0.0786429356279404, Dist: 6834.407687669538}, GeoRecord{ID: "736914", Lat: 0.8978071759762793, Long: 0.09550240954048993, Dist: 6750.953005194616}, GeoRecord{ID: "1144327", Lat: 0.9045320604839073, Long: 0.10172795709445166, Dist: 6754.775836823247}, GeoRecord{ID: "276619", Lat: 0.8531878458663491, Long: 0.04071445261456579, Dist: 6790.329194909059}, GeoRecord{ID: "382095", Lat: 0.730568011391528, Long: 0.21786541881588, Dist: 5701.959310962512}, GeoRecord{ID: "482231", Lat: 0.9060679798962598, Long: 0.07766536449659361, Dist: 6838.775453526755}, GeoRecord{ID: "498405", Lat: 0.9290455780926398, Long: 0.11411520805833716, Dist: 6805.71013388731}, GeoRecord{ID: "20020", Lat: 0.9062169245492956, Long: 0.07878301924436398, Dist: 6835.626221798553}, GeoRecord{ID: "201531", Lat: 0.9062286060379792, Long: 0.07862635674537571, Dist: 6836.181376411577}, GeoRecord{ID: "440291", Lat: 0.9001311429618336, Long: 0.08398978495268082, Dist: 6797.133877572342}, GeoRecord{ID: "383149", Lat: 0.6889043317926677, Long: -0.006716384754170839, Dist: 6522.392787270811}, GeoRecord{ID: "19097", Lat: 0.8875933451326589, Long: 0.0987671578620882, Dist: 6703.739976453256}, GeoRecord{ID: "286501", Lat: 0.9167239096207273, Long: 0.23412433540479383, Dist: 6398.970796427882}}

	expectedAfterSort = []GeoRecord{GeoRecord{ID: "382095", Lat: 0.730568011391528, Long: 0.21786541881588, Dist: 5701.959310962512}, GeoRecord{ID: "280398", Lat: 0.9167361496147717, Long: 0.2341940386191307, Dist: 6398.824867596797}, GeoRecord{ID: "286501", Lat: 0.9167239096207273, Long: 0.23412433540479383, Dist: 6398.970796427882}, GeoRecord{ID: "259934", Lat: 0.9171652859352641, Long: 0.23421114284580027, Dist: 6400.628444189399}, GeoRecord{ID: "264170", Lat: 0.7222508926779028, Long: 0.03818076861142114, Dist: 6410.577022747781}, GeoRecord{ID: "224462", Lat: 0.7226196545689103, Long: 0.03724242550034218, Dist: 6415.637191380809}, GeoRecord{ID: "383227", Lat: 0.688941318810176, Long: -0.006555238504334203, Dist: 6521.751049245793}, GeoRecord{ID: "383149", Lat: 0.6889043317926677, Long: -0.006716384754170839, Dist: 6522.392787270811}, GeoRecord{ID: "381783", Lat: 0.7269676170561494, Long: -0.015353225097481119, Dist: 6655.350457923642}, GeoRecord{ID: "381823", Lat: 0.6487040461944226, Long: -0.06288398605655295, Dist: 6695.009206838496}, GeoRecord{ID: "382582", Lat: 0.6488587382166852, Long: -0.0629871350153458, Dist: 6695.821593686801}, GeoRecord{ID: "13506", Lat: 0.8870683082057569, Long: 0.09959403028450077, Dist: 6699.111872133778}, GeoRecord{ID: "22238", Lat: 0.8874026469679275, Long: 0.09975754145547386, Dist: 6699.757730150401}, GeoRecord{ID: "529990", Lat: 0.8872531298468967, Long: 0.09936504483196835, Dist: 6700.534164128012}, GeoRecord{ID: "24389", Lat: 0.8875231235555341, Long: 0.09953927406987795, Dist: 6700.914850208654}, GeoRecord{ID: "420178", Lat: 0.8874866845714109, Long: 0.09931575847922129, Dist: 6701.530404262073}, GeoRecord{ID: "23928", Lat: 0.8877650035005802, Long: 0.0996123667136222, Dist: 6701.533132472086}, GeoRecord{ID: "1099981", Lat: 0.8874644682753623, Long: 0.0992859168396707, Dist: 6701.550803150888}, GeoRecord{ID: "636618", Lat: 0.8875598417923375, Long: 0.09920700177754178, Dist: 6702.153666957753}, GeoRecord{ID: "498815", Lat: 0.8874211369860231, Long: 0.09887526355595672, Dist: 6702.766387588749}, GeoRecord{ID: "19097", Lat: 0.8875933451326589, Long: 0.0987671578620882, Dist: 6703.739976453256}, GeoRecord{ID: "736914", Lat: 0.8978071759762793, Long: 0.09550240954048993, Dist: 6750.953005194616}, GeoRecord{ID: "1144327", Lat: 0.9045320604839073, Long: 0.10172795709445166, Dist: 6754.775836823247}, GeoRecord{ID: "260185", Lat: 0.9120353024967303, Long: 0.10801819004115079, Dist: 6761.871341647243}, GeoRecord{ID: "270765", Lat: 0.852704703822812, Long: 0.041679357891530856, Dist: 6785.289878354843}, GeoRecord{ID: "419117", Lat: 0.852860484930528, Long: 0.04152973954140364, Dist: 6786.328066723885}, GeoRecord{ID: "276619", Lat: 0.8531878458663491, Long: 0.04071445261456579, Dist: 6790.329194909059}, GeoRecord{ID: "378673", Lat: 0.8533097536239422, Long: 0.04081459437105747, Dist: 6790.3518768437625}, GeoRecord{ID: "440291", Lat: 0.9001311429618336, Long: 0.08398978495268082, Dist: 6797.133877572342}, GeoRecord{ID: "492800", Lat: 0.9086618201627328, Long: 0.0920418056062206, Dist: 6801.02758243488}, GeoRecord{ID: "1049721", Lat: 0.9289509568125721, Long: 0.1147634495224666, Dist: 6803.354598104192}, GeoRecord{ID: "228617", Lat: 0.9288719876452365, Long: 0.11460845555824326, Dist: 6803.537824233478}, GeoRecord{ID: "12714", Lat: 0.929032592843005, Long: 0.11441577295415234, Dist: 6804.733412466837}, GeoRecord{ID: "206888", Lat: 0.928990668289043, Long: 0.1142555901260628, Dist: 6805.071327151288}, GeoRecord{ID: "498405", Lat: 0.9290455780926398, Long: 0.11411520805833716, Dist: 6805.71013388731}, GeoRecord{ID: "224458", Lat: 0.928875708687202, Long: 0.11390616822849652, Dist: 6805.721080612187}, GeoRecord{ID: "537608", Lat: 0.9290893614222554, Long: 0.11407977961985091, Dist: 6805.983195156919}, GeoRecord{ID: "19880", Lat: 0.9290662078843985, Long: 0.1138944588145449, Dist: 6806.4690367538715}, GeoRecord{ID: "577771", Lat: 0.9087258266223911, Long: 0.08933394472504391, Dist: 6810.041312793595}, GeoRecord{ID: "512718", Lat: 0.908958700668497, Long: 0.08958078838648273, Dist: 6810.069796726029}, GeoRecord{ID: "505868", Lat: 0.909280146683483, Long: 0.08930616257401067, Dist: 6812.106504497622}, GeoRecord{ID: "286275", Lat: 0.9091955750092484, Long: 0.0888418753223829, Dist: 6813.31185562441}, GeoRecord{ID: "133451", Lat: 0.7056539232661702, Long: -0.06494199104404205, Dist: 6826.066177531431}, GeoRecord{ID: "381769", Lat: 0.9126925585864464, Long: 0.08715222556418568, Dist: 6831.235776240795}, GeoRecord{ID: "488611", Lat: 0.9057881722012384, Long: 0.07872167964780263, Dist: 6834.326517927309}, GeoRecord{ID: "520857", Lat: 0.9057374599144925, Long: 0.0786429356279404, Dist: 6834.407687669538}, GeoRecord{ID: "508337", Lat: 0.9060613720797115, Long: 0.0789318661589618, Dist: 6834.592861941546}, GeoRecord{ID: "41124", Lat: 0.906130406832945, Long: 0.07899400337099129, Dist: 6834.6306766367825}, GeoRecord{ID: "841036", Lat: 0.9131844080776217, Long: 0.08644947048619946, Dist: 6835.256878130669}, GeoRecord{ID: "20020", Lat: 0.9062169245492956, Long: 0.07878301924436398, Dist: 6835.626221798553}, GeoRecord{ID: "436807", Lat: 0.9062182614715025, Long: 0.07878427239076691, Dist: 6835.626790104652}, GeoRecord{ID: "900838", Lat: 0.9135344164058167, Long: 0.08669200667504431, Dist: 6835.719456539301}, GeoRecord{ID: "206311", Lat: 0.9061843305255146, Long: 0.07871510848316889, Dist: 6835.7350128873695}, GeoRecord{ID: "201844", Lat: 0.9061843305255146, Long: 0.07871510848316889, Dist: 6835.7350128873695}, GeoRecord{ID: "22310", Lat: 0.9062010682330411, Long: 0.07864584509180349, Dist: 6836.020990256374}, GeoRecord{ID: "201531", Lat: 0.9062286060379792, Long: 0.07862635674537571, Dist: 6836.181376411577}, GeoRecord{ID: "505845", Lat: 0.9063631656873201, Long: 0.07869258326384264, Dist: 6836.435144865021}, GeoRecord{ID: "444464", Lat: 0.9063962553846087, Long: 0.07862798339223856, Dist: 6836.763016690811}, GeoRecord{ID: "28403", Lat: 0.9062545608292857, Long: 0.07840075548626291, Dist: 6837.012846904176}, GeoRecord{ID: "25182", Lat: 0.9062606816989722, Long: 0.07837563321700972, Dist: 6837.116746428064}, GeoRecord{ID: "429151", Lat: 0.9062732044363552, Long: 0.07833097722276819, Dist: 6837.307180676477}, GeoRecord{ID: "512818", Lat: 0.9062938953146378, Long: 0.07834908675908689, Dist: 6837.320138433589}, GeoRecord{ID: "285782", Lat: 0.9062684257248634, Long: 0.0783008772744883, Dist: 6837.389279181325}, GeoRecord{ID: "442406", Lat: 0.9063000371282756, Long: 0.07822944618419192, Dist: 6837.7344161520205}, GeoRecord{ID: "478223", Lat: 0.9059621832729915, Long: 0.07785602950006924, Dist: 6837.779135174724}, GeoRecord{ID: "201792", Lat: 0.9064219710658077, Long: 0.07829526080495539, Dist: 6837.9450655947185}, GeoRecord{ID: "41238", Lat: 0.9059249745986683, Long: 0.07775356820100164, Dist: 6837.985726077332}, GeoRecord{ID: "254577", Lat: 0.9064371833555681, Long: 0.07820308124051133, Dist: 6838.300875645867}, GeoRecord{ID: "481742", Lat: 0.9059994617604848, Long: 0.07763262386515546, Dist: 6838.643525578349}, GeoRecord{ID: "50356", Lat: 0.9063702848853391, Long: 0.0780150551748647, Dist: 6838.6840772393}, GeoRecord{ID: "482231", Lat: 0.9060679798962598, Long: 0.07766536449659361, Dist: 6838.775453526755}, GeoRecord{ID: "24624", Lat: 0.9021984418275895, Long: 0.07356037278518324, Dist: 6838.853801155598}, GeoRecord{ID: "441750", Lat: 0.9059863229218759, Long: 0.07749914631995068, Dist: 6839.036229876827}, GeoRecord{ID: "482365", Lat: 0.913935009611722, Long: 0.08607427880222746, Dist: 6839.138946499822}, GeoRecord{ID: "12533", Lat: 0.9064492941952476, Long: 0.07795199991964866, Dist: 6839.167479364043}, GeoRecord{ID: "41784", Lat: 0.9061747643758845, Long: 0.0776194972438512, Dist: 6839.299425593246}, GeoRecord{ID: "1049729", Lat: 0.9140577341834052, Long: 0.08557454391349167, Dist: 6841.188285597731}, GeoRecord{ID: "1144546", Lat: 0.9135997074278044, Long: 0.08489664406938305, Dist: 6841.749992574303}, GeoRecord{ID: "265405", Lat: 0.9141527132559696, Long: 0.08525362324261046, Dist: 6842.561761815388}, GeoRecord{ID: "503071", Lat: 0.9283680168424062, Long: 0.1011250121603992, Dist: 6843.52854700042}, GeoRecord{ID: "442637", Lat: 0.9140138443887054, Long: 0.08472475182734189, Dist: 6843.775956345362}, GeoRecord{ID: "249739", Lat: 0.9286411416717215, Long: 0.10091207501033886, Dist: 6845.195043780966}, GeoRecord{ID: "19405", Lat: 0.9074486452903298, Long: 0.07601021466172059, Dist: 6849.033196191546}, GeoRecord{ID: "285573", Lat: 0.9073841518838104, Long: 0.07581132217615107, Dist: 6849.460933370127}, GeoRecord{ID: "413700", Lat: 0.9059602930814117, Long: 0.07406146030408932, Dist: 6850.255336990507}, GeoRecord{ID: "28257", Lat: 0.9077856264809882, Long: 0.07595873268477452, Dist: 6850.378415675749}, GeoRecord{ID: "519522", Lat: 0.907826088449037, Long: 0.0758816310197384, Dist: 6850.772569905643}, GeoRecord{ID: "1098606", Lat: 0.910262705965832, Long: 0.07839783205976582, Dist: 6851.069941438913}, GeoRecord{ID: "453904", Lat: 0.9104087167203954, Long: 0.07854917828585252, Dist: 6851.088800067664}, GeoRecord{ID: "402981", Lat: 0.9103400694302558, Long: 0.07835547117349069, Dist: 6851.479639230558}, GeoRecord{ID: "19328", Lat: 0.9101691126846939, Long: 0.07763899780758374, Dist: 6853.2180021301665}, GeoRecord{ID: "23876", Lat: 0.9087224127583743, Long: 0.07544819071731038, Dist: 6855.322267367436}, GeoRecord{ID: "271949", Lat: 0.9089418861664833, Long: 0.07530903910670737, Dist: 6856.544202988409}, GeoRecord{ID: "90872", Lat: 0.9086558581180078, Long: 0.07392642417986249, Dist: 6860.0788545874375}, GeoRecord{ID: "382013", Lat: 0.6527435409349933, Long: -0.10422258062893668, Dist: 6902.308403017376}, GeoRecord{ID: "382693", Lat: 0.7150655815869524, Long: -0.09880399652661002, Dist: 7000.256434354976}, GeoRecord{ID: "422000", Lat: 0.9000054810010193, Long: -0.004077298572168993, Dist: 7095.3891433696535}, GeoRecord{ID: "381791", Lat: 0.8992140684330195, Long: -0.00552789407337904, Dist: 7098.018779396682}, GeoRecord{ID: "381776", Lat: 0.9153811108901083, Long: -0.0322092135875144, Dist: 7238.853148385706}, GeoRecord{ID: "7818", Lat: 0.6608995308520743, Long: -2.133823818071707, Dist: 15268.307349509038}}
)
